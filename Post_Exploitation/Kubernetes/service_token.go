// ChatGPT 4o generated

package main

import (
	"fmt"
	"log"
	"os"
)

func main() {
	// Possible locations of the service account token
	tokenPaths := []string{
		"/run/secrets/kubernetes.io/serviceaccount/token",
		"/var/run/secrets/kubernetes.io/serviceaccount/token",
		"/secrets/kubernetes.io/serviceaccount/token",
	}

	// Check each location and list available tokens
	fmt.Println("[*] Checking for service account tokens in 3 locations:")
	found := false
	for _, path := range tokenPaths {
		if _, err := os.Stat(path); err == nil {
			token, err := os.ReadFile(path)
			if err != nil {
				log.Printf("[-] Error reading service account token from %s: %v", path, err)
				continue
			}
			fmt.Printf("[+] Service Account Token found at %s:\n%s\n", path, string(token))
			found = true
		}
	}

	// If no token is found
	if !found {
		fmt.Println("[-] Service Account Token not found in any of the checked locations:")
		for _, path := range tokenPaths {
			fmt.Println("- " + path)
		}
	}
}
